extends ../main-frame

block content

    //-----------------------------------------------
    // Declarations start
    mixin link(href, name)
        //- attributes == {class: "btn"}
        .button-wrapper
            //<a class="btn btn-default" href="#" role="button">Link</a>
            a(class!=attributes.class href=href)= name

    //-Declarations end

    //-----------------------------------------------
    //-Page content start

    .event-banner
        img(src="/res/images/all-main.jpg", height=100 alt="extreme-sports-main-all")
        span Hey man, do a can-can ski fahren?!
        = '\n'
        = '\n'

    .event-conntent
        // Event pictures part
        .line
            each picture in event.pictures
                - var alt = 'event picture ' + picture.alt;
                img(src=event.pictures[0].src, width=150, height=100, alt=alt)
        |<hr>
        // Author details
        .line
            img(src=event.author.profilePicture.src, width=150, alt='profile picture ' + event.author.username)
            - var hrefUser = '/profile/' + event.author.username
            +link(hrefUser, event.author.username)

        | <hr>
        // Event body
        .line
            h2 #{event.title}
            h3 #{event.category} with date: #{event.date}

            = '\n'
            p #{event.body}
            = '\n'

        | <hr>
        // Interested in and Participating In info and  buttons
        p #{event.interestedIn.length} people interested in going.
            ul
                each userInterested in event.interestedIn
                    li
                        - var hrefUser = '/profile/' + userInterested
                        +link(hrefUser, userInterested)
                        ='\n'
        p #{event.participatingIn.length} people participating the event.
            ul
                each userParticipating in event.participatingIn
                    li
                        - var hrefUser = '/profile/' + userParticipating
                        +link(hrefUser, userParticipating)
                        ='\n'

        +link('/categories/ski/interested/' + event._id, 'Im interested too')(class="btn btn-default" role="button")
        +link('/categories/ski/sure-participate/' + event._id, 'I will participate')(class="btn btn-default" role="button")








    .panel.text-center
        .panel-heading
            h2 Comments:
            each comment in event.comments
                if !comment.hidden
                    .panel-footer
                        p #{comment.body}
                        a(href="/profile/" + comment.author)= comment.author
                        br
                        | Created on: #{comment.date}
                        if user && (user.username == comment.author || user.role == "admin")
                            form(action="/comments/" + comment._id + "/delete-comment/" + comment._id, method="POST")
                                button.btn.btn-xs.btn-danger(type="submit") Delete Comment

    | <hr>
    if user
        button#btn-gallery-add-comment.btn.btn-warning.btn-block(href="#" data-toggle="modal" data-target="#gallery-comment-modal") Add Comment

    #gallery-comment-modal.modal.fade(role='dialog')
        .modal-dialog.modal-lg
            .modal-content
            .modal-header
                button.close(type='button', data-dismiss='modal') &times;
                h3.modal-title(style="color: white") Add Comment:
            .modal-body
                form.form-group(action="/comments/post-comment-to-event/" + event._id  method="POST")
                    input.form-control(type="text" name="comment" placeholder="What do you think...")
                    br
                    button.btn.btn-success.btn-md(type="submit") Submit
                    span
                    button.btn.btn-danger(type='button', data-dismiss='modal' onclick="false") Discard